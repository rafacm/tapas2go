<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:int="http://www.springframework.org/schema/integration"
       xmlns:int-twitter="http://www.springframework.org/schema/integration/twitter"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/integration
		http://www.springframework.org/schema/integration/spring-integration.xsd
		http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/integration/twitter
		http://www.springframework.org/schema/integration/twitter/spring-integration-twitter.xsd
		http://www.springframework.org/schema/context
		http://www.springframework.org/schema/context/spring-context.xsd">

    <!-- See also: http://static.springsource.org/spring-integration/reference/htmlsingle/#channel
    http://www.eaipatterns.com/MessageChannel.html -->
    <int:channel id="twitterInChannel">
        <int:interceptors>
            <int:wire-tap channel="fullLogger" />
        </int:interceptors>
    </int:channel>

    <int:channel id="twitterOutChannel" />

    <!-- Avoid duplicates. See http://static.springsource.org/spring-integration/reference/htmlsingle/#twitter-inbound -->
    <!--<bean id="metadataStore" class="org.springframework.integration.store.PropertiesPersistingMetadataStore"/>-->

    <!-- See also: http://static.springsource.org/spring-integration/reference/htmlsingle/#service-activator
        http://www.eaipatterns.com/MessagingAdapter.html -->
    <int:service-activator id="twitterServiceActivator"
                           input-channel="twitterInChannel" output-channel="twitterOutChannel" ref="twitterService"
                           method="replyToTweet" />

    <bean id="twitterService" class="com.plexiti.samples.tapas2go.service.impl.DefaultTwitterService"/>

    <int:logging-channel-adapter id="logger"
                                 level="INFO"
                                 expression="'Headers:' + headers + 'Id:' + payload.id + '; Date:' + payload.createdAt + '; FromUser: ' + payload.fromUser + '; Tweet: ' + payload.text" />

    <int:logging-channel-adapter id="fullLogger"
                                 level="INFO"
                                 log-full-message="true"/>

    <int:channel id="controlBusChannel" />

    <!-- See also: http://static.springsource.org/spring-integration/reference/htmlsingle/#control-bus
        http://www.eaipatterns.com/ControlBus.html -->
    <int:control-bus id="controlBus" input-channel="controlBusChannel" />

</beans>
